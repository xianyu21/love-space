"use strict";var e=Object.defineProperty,r=Object.defineProperties,t=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,u=(r,t,a)=>t in r?e(r,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[t]=a,l=(e,r)=>{for(var t in r||(r={}))o.call(r,t)&&u(e,t,r[t]);if(a)for(var t of a(r))n.call(r,t)&&u(e,t,r[t]);return e},f=(e,a)=>r(e,t(a)),i=require("../../../common/vendor.js"),d=require("../../tool/lib/minxs.js"),s=require("../../tool/lib/tmpinia.js");require("../../tool/theme/theme.js"),require("../../tool/theme/colortool.js"),require("../../tool/lib/interface.js"),require("../../../theme/index.js"),require("../../tool/function/util.js"),require("../../tool/function/preview.js"),Math||(c+m+h+p)();const p=()=>"../tm-sheet/tm-sheet.js",c=()=>"../tm-icon/tm-icon.js",m=()=>"../tm-text/tm-text.js",h=()=>"../tm-button/tm-button.js",b=i.defineComponent({props:f(l({},d.custom_props),{followTheme:{type:[Boolean,String],default:!0},color:{type:String,default:"grey-4"},focusColor:{type:String,default:"primary"},fontColor:{type:String,default:""},text:{type:Boolean,default:!0},outlined:{type:Boolean,default:!1},border:{type:Number,default:0},transprent:{type:Boolean,default:!1},round:{type:Number,default:3},shadow:{type:Number,default:0},margin:{type:Array,default:()=>[0,0]},padding:{type:Array,default:()=>[0,0]},height:{type:Number,default:64},prefix:{type:String,default:""},prefixLabel:{type:String,default:""},suffix:{type:String,default:""},suffixLabel:{type:String,default:""},fontSize:{type:Number,default:30},search:{type:String,default:""},searchLabel:{type:String,default:""},showClear:{type:Boolean,default:!1},password:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},placeholder:{type:String,default:"请输入内容"},errorLabel:{type:String,default:"请输入内容"},align:{type:String,default:"left"},modelValue:{type:[String,Number],default:""},inputPadding:{type:Array,default:()=>[24,0]},showCharNumber:{type:Boolean,default:!1},maxlength:{type:Number,default:-1},type:{type:String,default:"text"},cursorSpacing:{type:Number,default:24},confirmType:{type:String,default:"done"},confirmHold:{type:Boolean,default:!1},autoBlur:{type:Boolean,default:!0},holdKeyboard:{type:Boolean,default:!1},adjustPosition:{type:Boolean,default:!0},focus:{type:Boolean,default:!1},cursor:{type:Number,default:0},showConfirmBar:{type:Boolean,default:!0},selectionStart:{type:Number,default:-1},selectionEnd:{type:Number,default:-1},disableDefaultPadding:{type:Boolean,default:!1},fixed:{type:Boolean,default:!1}}),emits:["focus","blur","confirm","input","update:modelValue","clear","search","keyboardheightchange","click"],setup(e,{emit:r}){var t;const a=e,o=s.useTmpiniaStore(),{proxy:n}=i.getCurrentInstance();let u=n.$parent;for(;u&&"tmFormComnameFormItem"!=(null==u?void 0:u.tmFormComnameFormItem)&&u;)u=null!=(t=null==u?void 0:u.$parent)?t:void 0;const p=i.ref(!1);p.value="android"==i.index.getSystemInfoSync().platform;const c=i.computed$1((()=>a.height)),m=i.computed$1((()=>""!==a.search||""!==a.searchLabel?[4,0]:a.inputPadding)),h=i.computed$1((()=>({focus:a.focus,prefix:a.prefix,prefixLabel:a.prefixLabel,fontSize:a.fontSize,fontSize_px:i.index.upx2px(a.fontSize),suffix:a.suffix,suffixLabel:a.suffixLabel,fontColor:a.fontColor,search:a.search,searchLabel:a.searchLabel,showClear:a.showClear,password:a.password,disabled:a.disabled,placeholder:a.placeholder,showCharNumber:a.showCharNumber,maxlength:a.maxlength,cursorSpacing:a.cursorSpacing,confirmType:a.confirmType,confirmHold:a.confirmHold,autoBlur:a.autoBlur,holdKeyboard:a.holdKeyboard,adjustPosition:a.adjustPosition,type:a.type,cursor:a.cursor,showConfirmBar:a.showConfirmBar,selectionStart:a.selectionStart,selectionEnd:a.selectionEnd,disableDefaultPadding:a.disableDefaultPadding,fixed:a.fixed}))),b=i.computed$1((()=>o.tmStore));i.computed$1((()=>d.computedStyle(a))),i.computed$1((()=>d.computedClass(a)));const y=i.computed$1((()=>d.computedDark(a,b.value))),x=i.ref(!1),g=i.ref(a.focus||!1);i.watch((()=>a.focus),(()=>{g.value=a.focus}));const v=i.computed$1((()=>{let e=a.color;return g.value&&(e=a.followTheme&&o.tmStore.color?o.tmStore.color:a.focusColor),x.value&&(e="red"),e})),S=i.computed$1((()=>{const e=f(l({},a),{color:v.value});return d.computedTheme(e,y.value,b.value)})),w=i.ref(h.value.password),C=i.computed$1((()=>a.password));i.ref(a.errorLabel);const z=i.ref(a.modelValue),j=i.computed$1((()=>String(z.value).split("").length));i.watch((()=>a.modelValue),(()=>z.value=a.modelValue));const B=i.inject("tmFormItemRules",i.computed$1((()=>{var e;return[{message:null!=(e=null==a?void 0:a.errorLabel)?e:"请填写必要的内容",required:!1,validator:!1}]})));function $(){r("search",z.value)}function L(){z.value="",r("update:modelValue",""),r("clear")}function P(){w.value=!w.value}function N(){g.value=!0,r("focus")}function k(){g.value=!1,E(),r("blur")}function q(){r("confirm",z.value)}function T(e){return z.value=e.detail.value,r("input",e.detail.value),r("update:modelValue",e.detail.value),e.detail.value}i.watch(z,(()=>i.index.$tm.u.debounce((()=>E()),350)));const D=i.inject("tmFormFun",i.computed$1((()=>"")));async function E(e=!0){u&&e&&(e=>{let r=(e=e.map((e=>"function"==typeof e.validator&&!0===e.required?e:"boolean"==typeof e.validator&&!0===e.required?f(l({},e),{validator:e=>0!=String(e).length&&null!==typeof e}):f(l({},e),{validator:e=>!0})))).filter((e=>"function"==typeof e.validator&&!0===e.required)).map((e=>new Promise((async(r,t)=>{"function"==typeof e.validator?await e.validator(z.value)?r({message:String(e.message),validator:!0}):t({message:e.message,validator:!1}):r({message:e.message,validator:!0})}))));return Promise.all(r)})(i.toRaw(B.value)).then((e=>{u.pushCom({value:z.value,isRequiredError:!1,componentsName:"tm-input",message:e[0].message})})).catch((e=>{u.pushCom({value:z.value,isRequiredError:!0,componentsName:"tm-input",message:e.message})}))}return i.watch(D,(()=>{"validate"==D.value&&E(),"reset"==D.value&&(z.value="",x.value=!1,r("update:modelValue",z.value),E(!1)),"clearValidate"==D.value&&(x.value=!1,E(!1))})),E(!1),(e,t)=>i.e({a:i.unref(h).search||i.unref(h).searchLabel},(i.unref(h).search||i.unref(h).searchLabel,{}),{b:i.unref(h).prefix},i.unref(h).prefix?{c:i.p({"font-size":i.unref(h).fontSize,name:i.unref(h).prefix})}:{},{d:i.unref(h).prefixLabel},i.unref(h).prefixLabel?{e:i.p({"font-size":i.unref(h).fontSize,label:i.unref(h).prefixLabel})}:{},{f:!p.value},p.value?{}:i.e({g:"textarea"!=i.unref(h).type},"textarea"!=i.unref(h).type?{h:z.value,i:i.unref(h).focus,j:i.o(N),k:i.o(k),l:i.o(q),m:i.o(T),n:i.o((e=>r("keyboardheightchange"))),o:w.value,p:i.unref(h).maxlength,q:i.unref(h).disabled,r:i.unref(h).cursorSpacing,s:i.unref(h).confirmType,t:i.unref(h).confirmHold,v:i.unref(h).autoBlur,w:i.unref(h).holdKeyboard,x:i.unref(h).adjustPosition,y:i.unref(h).type,z:i.unref(h).placeholder,A:i.s({height:`${i.unref(c)}rpx`,color:i.unref(h).fontColor?i.unref(h).fontColor:i.unref(S).textColor,"text-align":a.align,fontSize:`${i.unref(h).fontSize_px}px`}),B:`fontSize:${i.unref(h).fontSize_px}px`}:{},{C:"textarea"==i.unref(h).type},"textarea"==i.unref(h).type?{D:z.value,E:i.unref(h).focus,F:i.o(N),G:i.o(k),H:i.o(q),I:i.o(T),J:i.o((e=>r("keyboardheightchange"))),K:i.unref(h).maxlength,L:i.unref(h).disabled,M:i.unref(h).placeholder,N:i.unref(h).cursorSpacing,O:i.unref(h).confirmType,P:i.unref(h).confirmHold,Q:i.unref(h).autoBlur,R:i.unref(h).holdKeyboard,S:i.unref(h).cursor,T:i.unref(h).showConfirmBar,U:i.unref(h).selectionStart,V:i.unref(h).selectionEnd,W:i.unref(h).disableDefaultPadding,X:i.unref(h).fixed,Y:i.unref(h).adjustPosition,Z:i.unref(h).type,aa:i.s({height:`${i.unref(c)}rpx`,width:"auto","word-break":"break-word",color:i.unref(h).fontColor?i.unref(h).fontColor:i.unref(S).textColor,"text-align":a.align,fontSize:`${i.unref(h).fontSize_px}px`}),ab:`fontSize:${i.unref(h).fontSize_px}px`}:{},{ac:i.o((e=>r("click",e))),ad:i.s({width:"0px"})}),{ae:p.value},p.value?i.e({af:"textarea"!=i.unref(h).type},"textarea"!=i.unref(h).type?{ag:i.o((e=>r("click",e))),ah:z.value,ai:i.unref(h).focus,aj:i.o(N),ak:i.o(k),al:i.o(q),am:i.o(T),an:i.o((e=>r("keyboardheightchange"))),ao:w.value,ap:i.unref(h).disabled,aq:i.unref(h).cursorSpacing,ar:i.unref(h).confirmType,as:i.unref(h).confirmHold,at:i.unref(h).autoBlur,av:i.unref(h).holdKeyboard,aw:i.unref(h).adjustPosition,ax:i.unref(h).maxlength,ay:i.unref(h).type,az:i.unref(h).placeholder,aA:i.s({height:`${i.unref(c)}rpx`,color:i.unref(h).fontColor?i.unref(h).fontColor:i.unref(S).textColor,"text-align":a.align,fontSize:`${i.unref(h).fontSize_px}px`}),aB:`fontSize:${i.unref(h).fontSize_px}px`}:{},{aC:"textarea"==i.unref(h).type},"textarea"==i.unref(h).type?{aD:i.o((e=>r("click",e))),aE:z.value,aF:i.unref(h).focus,aG:i.o(N),aH:i.o(k),aI:i.o(q),aJ:i.o(T),aK:i.o((e=>r("keyboardheightchange"))),aL:i.unref(h).disabled,aM:i.unref(h).placeholder,aN:i.unref(h).cursorSpacing,aO:i.unref(h).confirmType,aP:i.unref(h).confirmHold,aQ:i.unref(h).autoBlur,aR:i.unref(h).holdKeyboard,aS:i.unref(h).adjustPosition,aT:i.unref(h).maxlength,aU:i.unref(h).autoHeight,aV:i.unref(h).cursor,aW:i.unref(h).showConfirmBar,aX:i.unref(h).selectionStart,aY:i.unref(h).selectionEnd,aZ:i.unref(h).disableDefaultPadding,ba:i.unref(h).fixed,bb:i.unref(h).type,bc:i.s({height:`${i.unref(c)}rpx`,width:"auto","word-break":"break-word",color:i.unref(h).fontColor?i.unref(h).fontColor:i.unref(S).textColor,"text-align":a.align,fontSize:`${i.unref(h).fontSize_px}px`}),bd:`fontSize:${i.unref(h).fontSize_px}px`}:{},{be:i.s({width:"0px"})}):{},{bf:i.unref(h).showClear&&i.unref(j)>0},i.unref(h).showClear&&i.unref(j)>0?{bg:i.o(L),bh:i.p({"font-size":.9*i.unref(h).fontSize,name:"tmicon-times-circle-fill"})}:{},{bi:x.value},x.value?{bj:i.p({"font-size":i.unref(h).fontSize,name:"tmicon-exclamation-circle"})}:{},{bk:i.unref(h).suffix},i.unref(h).suffix?{bl:i.p({"font-size":.85*i.unref(h).fontSize,name:i.unref(h).suffix})}:{},{bm:i.unref(h).suffixLabel},i.unref(h).suffixLabel?{bn:i.p({"font-size":i.unref(h).fontSize,label:i.unref(h).suffixLabel})}:{},{bo:i.unref(C)},i.unref(C)?{bp:i.o(P),bq:i.p({"font-size":i.unref(h).fontSize,name:w.value?"tmicon-eyeslash-fill":"tmicon-eye-fill"})}:{},{br:i.unref(h).showCharNumber&&i.unref(j)>0&&"textarea"!=i.unref(h).type},i.unref(h).showCharNumber&&i.unref(j)>0&&"textarea"!=i.unref(h).type?i.e({bs:i.p({label:i.unref(j)}),bt:i.unref(h).maxlength>0},i.unref(h).maxlength>0?{bv:i.p({label:"/"+i.unref(h).maxlength})}:{}):{},{bw:i.unref(h).showCharNumber&&i.unref(j)>0&&"textarea"==i.unref(h).type},i.unref(h).showCharNumber&&i.unref(j)>0&&"textarea"==i.unref(h).type?i.e({bx:i.p({label:i.unref(j)}),by:i.unref(h).maxlength>0},i.unref(h).maxlength>0?{bz:i.p({label:"/"+i.unref(h).maxlength})}:{}):{},{bA:i.unref(h).search||i.unref(h).searchLabel},i.unref(h).search||i.unref(h).searchLabel?{bB:i.o($),bC:i.p({followTheme:a.followTheme,color:a.focusColor,"font-size":24,height:i.unref(c)-11,padding:[16,0],block:!0,margin:[0,0],icon:i.unref(h).search,label:i.unref(h).searchLabel})}:{},{bD:i.n("textarea"==i.unref(h).type?"flex-row-top-center":"flex-row-center-center"),bE:i.s({height:`${i.unref(c)}rpx`}),bF:i.p({transprent:a.transprent,round:a.round,"no-level":!0,margin:[0,0],padding:i.unref(m),border:a.border,text:a.text,color:i.unref(v),outlined:a.outlined,shadow:a.shadow,linear:a.linear,linearDeep:a.linearDeep}),bG:i.p({transprent:!0,margin:a.margin,padding:a.padding})})}});wx.createComponent(b);
